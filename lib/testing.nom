require "lib/metaprogramming.nom"

# For unit testing
macro block [test %code yields %expected] =:
    %generated =: repr (nomsu "stringify_tree" [%code's "value"])
    %expected =: %expected as lua
    if (%generated != %expected):
        say "Test failed!"
        say "Expected:"
        say %expected
        say "But got:"
        say %generated
        error!
    return ""
